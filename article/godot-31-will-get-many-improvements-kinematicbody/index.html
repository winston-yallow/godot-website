<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Godot Engine"><meta name=description content="One of the features that make Godot stand out is how easy it is to use the physics engine for non-physics games. For Godot 3.1, several improvements are being worked on."><meta name=theme-color content="#3d8fcc"><meta property="og:site_name" content="Godot Engine"><meta property="og:url" content="https://godotengine.org/article/godot-31-will-get-many-improvements-kinematicbody/"><meta name=twitter:site content="@godotengine"><meta property="og:title" content="Godot 3.1 will get many improvements to KinematicBody"><meta property="og:description" content="One of the features that make Godot stand out is how easy it is to use the physics engine for non-physics games. For Godot 3.1, several improvements are being worked on."><meta property="og:image" content="https://godotengine.org/storage/app/uploads/public/5b4/de9/702/5b4de97024c77681425121.gif"><meta property="og:type" content="article"><meta name=twitter:card content="summary_large_image"><title>Godot 3.1 will get many improvements to KinematicBody</title><link rel=alternate type=application/rss+xml title="Godot News" href=/rss.xml><link rel=icon href=/assets/favicon.png sizes=any><link rel=icon href=/assets/favicon.svg type=image/svg+xml><link rel=stylesheet href=/assets/css/main.css?112><link rel=stylesheet href=/assets/css/tobii.min.css><link rel=preload as=font href=/assets/fonts/Montserrat-Bold.woff2 crossorigin><link rel=preload as=font href=/assets/fonts/Montserrat-ExtraBold.woff2 crossorigin><link rel=me href=https://mastodon.gamedev.place/@godotengine><input type=checkbox id=nav_toggle_cb><header><div class="container flex align-center"><div id=nav_head><a href=/ id=logo-link><img class=nav-logo src=/assets/logo.svg width=136 height=48 alt="Godot Engine">
<img class="nav-logo dark-logo" src=/assets/logo_dark.svg width=136 height=48 alt="Godot Engine"></a>
<label for=nav_toggle_cb id=nav_toggle_btn><img src=/assets/icons/hamburger.svg width=24 height=24 alt="Main menu"></label></div><nav id=nav><ul class=left><li><a href=/features/>Features</a><li class=only-on-mobile><a href=/showcase/>Showcase</a><li><a href=/blog/>Blog</a><li><a href=/community/>Community</a><li><a href=/contact/>About</a><li><a href=https://godotengine.org/asset-library/asset>Assets</a></ul><ul class=right><li><a href=/download/windows/ class=set-os-download-url>Download</a><li><a href=https://docs.godotengine.org>Docs</a><li><a href=https://docs.godotengine.org/en/stable/community/contributing/index.html>Contribute</a><li class=fund><a href=https://fund.godotengine.org>‚ù§&#xFE0E; Donate</a></ul></nav></div></header><main><style>body{background-color:var(--background-color)}h1{margin-bottom:8px;margin-top:32px}:not(pre)>code{background:var(--code-background-color);padding:1px 4px;font-size:.95em;border-radius:3px}pre{background:var(--codeblock-background-color);color:var(--codeblock-color)}pre code{display:block;overflow-x:auto;padding:.5em}.date-big{line-height:2;margin-left:32px}article{background-color:var(--base-color);box-shadow:0 3px 2px rgba(0,0,0,.15)}figure{margin:0}figure img{margin:0}article img,article video{max-width:100%;height:auto;display:block;margin:auto;margin-top:16px;margin-bottom:16px}article h1{margin-top:64px}article h2,article h3,article h4{margin-top:42px}.article-info{display:flex;flex-direction:column;gap:8px}.article-metadata{display:flex;gap:24px;align-items:center;font-family:var(--header-font-family);margin-bottom:12px}@media(max-width:900px){.article-metadata{flex-direction:column;align-items:flex-start;gap:16px}}.article-author{color:var(--base-color-text-subtitle-date);font-weight:700;font-size:18px;flex-grow:1;display:flex;gap:12px;align-items:center}.article-author .avatar{border-radius:100%;margin:0}.article-author .by{color:var(--base-color-text-subtitle)}.article-metadata .date{color:var(--base-color-text-subtitle-date)}.article-metadata .date.post-recent-highlight{color:var(--post-recent-highlight-color);opacity:.8}.article-metadata .date.post-recent-highlight::after{font-size:80%;content:"NEW";border:2px solid var(--post-recent-highlight-color);padding:2px 3px;margin-left:8px}.tag.active{filter:saturate(.75)}@media screen and (min-width:900px){article .content{width:70%;margin:auto}}@media(max-width:900px){body{background-color:var(--base-color)}article{background-color:initial;box-shadow:none}article img:first-child,article video:first-child{max-width:100%}}</style><link rel=stylesheet href=/assets/css/highlight.obsidian.min.css><div class=container><article class=padded><div class="content article-container"><figure class=article-cover><img src=/storage/app/uploads/public/5b4/de9/702/5b4de97024c77681425121.gif title alt=" " class=rounded-lg style=width:100%;height:auto;background-color:initial></figure><div class=article-info><h1>Godot 3.1 will get many improvements to KinematicBody</h1><div class=article-metadata><div class=article-author><span>By:</span>
<img class=avatar width=25 height=25 src=/assets/images/authors/reduzio.webp alt="Juan Linietsky" loading=lazy>
<span class=by>Juan Linietsky</span></div><span class=date data-post-date="2018-07-17 00:00:00 +0000">17 July 2018</span></div><div class=tags><a href=/blog/progress-report><div class="tag active">Progress Report</div></a></div></div><div class="card card-warning"><p>This article is from <strong>July 2018</strong>, some of its contents might be outdated and no longer accurate.<br>You can find up-to-date information about the engine in the <a href=https://docs.godotengine.org/en/stable/>official documentation</a>.</div><div class=article-body><h2 id=kinematicbody>KinematicBody</h2><p>One of the features that make Godot stand out is how easy it is to use the physics engine for non-physics games.
KinematicBody allows controlling a character entity around with a single function (<code class="language-plaintext highlighter-rouge">move_and_slide</code>). Simply pass a linear velocity, and it will be returned back adjusted while the player moves around the level.<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code>velocity = move_and_slide(velocity)
</code></pre></div></div><p>This function tries to move the character using that velocity and every time a collision is found, it will slide against it (and adjust the velocity accordingly). Some extra features are also present, such as specifying the floor direction:<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code>velocity = move_and_slide(velocity, Vector2(0, -1)) # floor points up
</code></pre></div></div><p>After the call, detecting if a character is on floor can be done with a call to:<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code>is_on_floor()
</code></pre></div></div><p>Likewise for walls. This allows adjusting the player animation accordingly. Godot also detects if the floor below is moving, and it will adjust the character accordingly too.<p>Unfortunately, despite the ease of use, this approach had a few limitations that could (or not) be evident depending on the type of game you were working on.<h2 id=snapping>Snapping</h2><p>The most obvious problem with this approach is snapping to the floor. As the character slides around the level, some situations may lead to the player flying around:<p><img src=/storage/app/uploads/public/5b4/ddc/4ca/5b4ddc4ca68ec721602355.gif alt=ramp_normal.gif><p>In some games, this effect may be desired (looks kind of cool), but in other types of games this is unacceptable.<p>To easily solve this, Godot 3.1 will introduce a new function: <strong><em><code class="language-plaintext highlighter-rouge">move_and_slide_with_snap</code></em></strong><p>This function allows a third parameter for a snap vector. It means that, while the character is standing on the floor, it will try to remain snapped to it. If no longer on ground, it will not try to snap again until it touches down.<p>The snap argument is a simple vector pointing towards a direction and length (how long it should try to search for the ground to snap)<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code># snap 32 pixels down
velocity = move_and_slide_with_snap(velocity, Vector2(0, -1), Vector2(0, 32))
</code></pre></div></div><p>This works very well in practice:<p><img src=/storage/app/uploads/public/5b4/ddd/89c/5b4ddd89cf5ab658278686.gif alt=samp_snap.gif><p>Of course, you must make sure to disable snap when the character jumps. Jumping is usually done by setting <code class="language-plaintext highlighter-rouge">velocity.y</code> to a negative velocity (like -100), but if snapping is active this will not work, as the character will snap back to the floor.<p>Disabling snap can be done by just passing a snap of length 0 (<code class="language-plaintext highlighter-rouge">Vector2()</code>) to <code class="language-plaintext highlighter-rouge">move_and_slide_with_snap()</code> or just by calling <code class="language-plaintext highlighter-rouge">move_and_slide()</code> instead.<p>A common trick for this is to have a <code class="language-plaintext highlighter-rouge">jumping</code> boolean variable and toggle it on when the character jumps:<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code># jump logic example with snapping
if is_on_floor() and Input.is_action_just_pressed("jump"):
    # can jump only when on floor
    velocity.y = -100
    jumping = true

# disable jumping when character is falling again
if jumping and velocity.y &gt; 0:
    jumping = false

# preset for snap, 32 pixels down
var snap = Vector2(0, 32)

# oh, but are we jumping? no snap then
if jumping:
    snap = Vector2()

velocity = move_and_slide_with_snap(velocity, Vector2(0, -1), snap)
</code></pre></div></div><h2 id=raycast-shapes>RayCast Shapes</h2><p>Another common situation (when using <code class="language-plaintext highlighter-rouge">move_and_slide()</code>) is that the character incurs more effort going up slopes than it does going down.<p><img src=/storage/app/uploads/public/5b4/ddd/89c/5b4ddd89cf5ab658278686.gif alt=samp_snap.gif><p>This is physically correct, but some types of game expect velocity to be constant when moving up and down in slopes.<p>The solution for this is now the same as when creating a dynamic character controller (physics-based), which is using RayCast shapes. They work now with KinematicBody.<p>RayCast shapes separate the body in the direction they are pointed to, and will always return a collision normal along their ray, instead of the one provided by the floor (because, again, their goal is to separate). Yes, the name is confusing, maybe they should be renamed to SeparationRayShape in Godot 4.0 :)<p>In any case, change the collision shape in your body to include a ray pointing down:<p><img src=/storage/app/uploads/public/5b4/de1/39c/5b4de139c8635728849121.png alt=separator_ray.png><p>And now, when moving around the stage, the speed will remain constant:<p><img src=/storage/app/uploads/public/5b4/de1/715/5b4de1715ad28642795319.gif alt=snap_raycast_snap.gif><p>Keep in mind that the maximum slope angle where this will work will be geometrically determined by the length of the ray, so make sure to adjust the ray length according to the approximate slope you want to support:<p><img src=/storage/app/uploads/public/5b4/dee/e3b/5b4deee3bc5bf782874519.png alt=slope_angle.png><p>As you can see in the picture above, the right slope is so steep that it hits the capsule before the ray, so this effectively disables the ray effect and makes the character incur a lot more effort. It happens naturally, without a single line of code needing to be written.<h2 id=sync-to-physics>Sync to Physics</h2><p>When a KinematicBody is moved around (be it using <code class="language-plaintext highlighter-rouge">move_and_slide</code>, or just moved around by modifying the <code class="language-plaintext highlighter-rouge">position</code>, <code class="language-plaintext highlighter-rouge">rotation</code>, etc. properties), it automatically computes its linear and angular velocity. This means that if either a box with physics (RigidBody) or a KinematicBody (that moves with <code class="language-plaintext highlighter-rouge">move_and_slide</code>) are standing over it, they will be moved along together.<p>This makes KinematicBody also very useful for moving platforms, elevators, scripted doors, etc.<p>The main limitation until now is that, when used as moving platform, its motion was always a frame ahead than the physics, so the character appears to slowly slide over it:<p><img src=/storage/app/uploads/public/5b4/de7/118/5b4de71180c66281786233.gif alt=moving_plat_old.gif><p>To compensate with this, a new option ‚Äú<em>Sync to Physics</em>‚Äù was added. This option is useful when animating via AnimationPlayer or tweaking the position/rotation properties manually in the object:<p><img src=/storage/app/uploads/public/5b4/de7/7cf/5b4de77cf3819709564138.png alt=sync_to_physics.png><p>When enabled, objects will appear in sync with the KinematicBody:<p><img src=/storage/app/uploads/public/5b4/de7/c23/5b4de7c231685692508567.gif alt=moving_plat_new.gif><h2 id=future>Future</h2><p>After these functions are well tested, they will be ported to the 3D engine, where they should work in the exact same way.<p>Once again, please remember that all this done with love for everyone. Our aim is to make a 100% free and open source game engine where the games you make with it are truly yours.<p>This progress is made possible thanks to the infinite generosity of our patrons. If you are not one yet, please consider <a href=https://www.patreon.com/godotengine>becoming our Patron</a>. This way, you don‚Äôt need to be an expert engine programmer to aid with Godot development :)</div></div></article></div><link rel=stylesheet href=/assets/css/anchor-link.css?1><link rel=stylesheet href=/assets/css/article-cards.css?2><script src=/assets/js/anchor-link.js></script>
<script>document.addEventListener('DOMContentLoaded',()=>{window.applyAnchorLinks('.article-body'),document.querySelectorAll('.article-cover img, .article-body img').forEach(b=>{if(b.classList.contains('lightbox-ignore'))return;const a=document.createElement('a');a.href=b.src,a.classList.add('lightbox'),a.dataset.group='article',b.parentNode.appendChild(a),a.appendChild(b)})})</script></main><footer><div class="container flex footer-container"><div id=copyright><p>¬© 2007-2024 Juan Linietsky, Ariel Manzur and <a href=https://github.com/godotengine/godot/blob/master/AUTHORS.md target=_blank rel=noopener>contributors</a>.<br>Hosted by the <a href=https://godot.foundation/ target=_blank rel=noopener>Godot Foundation</a>.<br>Website <a href=https://github.com/godotengine/godot-website target=_blank rel=noopener>source code on GitHub</a>.</div><div id=sitemap><ul class=sitemap-group><li><strong>Get Godot</strong><li><a href=/download/windows/ class=set-os-download-url>Download</a><li><a href=/download/archive/>Release Archive</a><li><a href=https://editor.godotengine.org/releases/latest/>Web Editor</a><li>&nbsp;<li><strong>Public Relations</strong><li><a href=/blog/>Blog</a><li><a href=/community/>Communities and Events</a><li><a href=/press/>Press Kit</a></ul><ul class=sitemap-group><li><strong>About Godot</strong><li><a href=/features/>Features</a><li><a href=/showcase/>Showcase</a><li><a href=/education/>Education</a><li><a href=/license/>License</a><li><a href=/code-of-conduct/>Code of Conduct</a><li><a href=/privacy-policy/>Privacy Policy</a><li><a href=https://fund.godotengine.org>Donate</a></ul><ul class=sitemap-group><li><strong>Project Team</strong><li><a href=/governance/>Governance</a><li><a href=/teams/>Teams</a><li>&nbsp;<li><strong>Extra Resources</strong><li><a href=https://godotengine.org/asset-library/asset>Asset Library</a><li><a href=https://docs.godotengine.org>Documentation</a><li><a href=https://github.com/godotengine>Code Repository</a></ul></div><div id=social class=dark-desaturate><h4 class=text-right><a href=/contact/>Contact us</a></h4><div class="flex justify-space-between" style=gap:3px><a href=https://github.com/godotengine target=_blank rel=noopener><img src=/assets/footer/github_logo.svg width=32 height=32 alt=GitHub></a>
<a href=https://mastodon.gamedev.place/@godotengine target=_blank rel=noopener><img src=/assets/footer/mastodon_logo.svg width=32 height=32 alt=Mastodon></a>
<a href=https://twitter.com/godotengine target=_blank rel=noopener><img src=/assets/footer/twitter_logo.svg width=32 height=32 alt=Twitter></a>
<a href=https://www.facebook.com/groups/godotengine/ target=_blank rel=noopener><img src=/assets/footer/facebook_logo.svg width=32 height=32 alt=Facebook></a>
<a href=https://www.reddit.com/r/godot target=_blank rel=noopener><img src=/assets/footer/reddit_logo.svg width=32 height=32 alt=Red‚Äãdit></a>
<a href=/rss.xml target=_blank rel=noopener><img src=/assets/footer/feed_logo.svg width=32 height=32 alt="RSS feed"></a></div></div></div></footer><script defer src=/assets/js/tobii.min.js></script>
<script defer src=/assets/js/highlight.min.js?1></script>
<script defer src=/assets/js/highlight.gdscript.min.js?1></script>
<script>document.addEventListener('DOMContentLoaded',()=>{document.querySelectorAll('pre code').forEach(a=>{hljs.highlightBlock(a)}),document.querySelectorAll('[data-post-date]').forEach(a=>{Date.parse(a.dataset.postDate)>Date.now()-1e3*60*60*48&&a.classList.add("post-recent-highlight")}),new Tobii({zoom:!1});const a=document.querySelectorAll('.set-os-download-url');for(let b=0;b<a.length;b++){const c=a[b];let e='download';'version'in c.dataset&&c.dataset.version==='3'&&(e='download/3.x');let d='windows';navigator.platform.indexOf('Mac')!==-1?d='macos':navigator.platform.indexOf('Linux')!==-1&&(d='linux'),c.href=`/${e}/${d}/`}})</script>