<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Godot Engine"><meta name=description content="Most of the internal code in Godot was written over a decade ago, and many design decisions that were taken back then, did not stand the test of time. January was spent mostly updating Godot internals and breaking compatibility, now that we have the chance."><meta name=theme-color content="#3d8fcc"><meta property="og:site_name" content="Godot Engine"><meta property="og:url" content="https://godotengine.org/article/godot-30-new-internals-progress-report-4/"><meta name=twitter:site content="@godotengine"><meta property="og:title" content="Godot 3.0 new internals, progress report #4"><meta property="og:description" content="Most of the internal code in Godot was written over a decade ago, and many design decisions that were taken back then, did not stand the test of time. January was spent mostly updating Godot internals and breaking compatibility, now that we have the chance."><meta property="og:image" content="https://godotengine.org/storage/app/uploads/public/589/720/444/5897204442764550068699.png"><meta property="og:type" content="article"><meta name=twitter:card content="summary_large_image"><title>Godot 3.0 new internals, progress report #4</title><link rel=alternate type=application/rss+xml title="Godot News" href=/rss.xml><link rel=icon href=/assets/favicon.png sizes=any><link rel=icon href=/assets/favicon.svg type=image/svg+xml><link rel=stylesheet href=/assets/css/main.css?112><link rel=stylesheet href=/assets/css/tobii.min.css><link rel=preload as=font href=/assets/fonts/Montserrat-Bold.woff2 crossorigin><link rel=preload as=font href=/assets/fonts/Montserrat-ExtraBold.woff2 crossorigin><link rel=me href=https://mastodon.gamedev.place/@godotengine><input type=checkbox id=nav_toggle_cb><header><div class="container flex align-center"><div id=nav_head><a href=/ id=logo-link><img class=nav-logo src=/assets/logo.svg width=136 height=48 alt="Godot Engine">
<img class="nav-logo dark-logo" src=/assets/logo_dark.svg width=136 height=48 alt="Godot Engine"></a>
<label for=nav_toggle_cb id=nav_toggle_btn><img src=/assets/icons/hamburger.svg width=24 height=24 alt="Main menu"></label></div><nav id=nav><ul class=left><li><a href=/features/>Features</a><li class=only-on-mobile><a href=/showcase/>Showcase</a><li><a href=/blog/>Blog</a><li><a href=/community/>Community</a><li><a href=/contact/>About</a><li><a href=https://godotengine.org/asset-library/asset>Assets</a></ul><ul class=right><li><a href=/download/windows/ class=set-os-download-url>Download</a><li><a href=https://docs.godotengine.org>Docs</a><li><a href=https://docs.godotengine.org/en/stable/community/contributing/index.html>Contribute</a><li class=fund><a href=https://fund.godotengine.org>❤&#xFE0E; Donate</a></ul></nav></div></header><main><style>body{background-color:var(--background-color)}h1{margin-bottom:8px;margin-top:32px}:not(pre)>code{background:var(--code-background-color);padding:1px 4px;font-size:.95em;border-radius:3px}pre{background:var(--codeblock-background-color);color:var(--codeblock-color)}pre code{display:block;overflow-x:auto;padding:.5em}.date-big{line-height:2;margin-left:32px}article{background-color:var(--base-color);box-shadow:0 3px 2px rgba(0,0,0,.15)}figure{margin:0}figure img{margin:0}article img,article video{max-width:100%;height:auto;display:block;margin:auto;margin-top:16px;margin-bottom:16px}article h1{margin-top:64px}article h2,article h3,article h4{margin-top:42px}.article-info{display:flex;flex-direction:column;gap:8px}.article-metadata{display:flex;gap:24px;align-items:center;font-family:var(--header-font-family);margin-bottom:12px}@media(max-width:900px){.article-metadata{flex-direction:column;align-items:flex-start;gap:16px}}.article-author{color:var(--base-color-text-subtitle-date);font-weight:700;font-size:18px;flex-grow:1;display:flex;gap:12px;align-items:center}.article-author .avatar{border-radius:100%;margin:0}.article-author .by{color:var(--base-color-text-subtitle)}.article-metadata .date{color:var(--base-color-text-subtitle-date)}.article-metadata .date.post-recent-highlight{color:var(--post-recent-highlight-color);opacity:.8}.article-metadata .date.post-recent-highlight::after{font-size:80%;content:"NEW";border:2px solid var(--post-recent-highlight-color);padding:2px 3px;margin-left:8px}.tag.active{filter:saturate(.75)}@media screen and (min-width:900px){article .content{width:70%;margin:auto}}@media(max-width:900px){body{background-color:var(--base-color)}article{background-color:initial;box-shadow:none}article img:first-child,article video:first-child{max-width:100%}}</style><link rel=stylesheet href=/assets/css/highlight.obsidian.min.css><div class=container><article class=padded><div class="content article-container"><figure class=article-cover><img src=/storage/app/uploads/public/589/720/444/5897204442764550068699.png title alt=" " class=rounded-lg style=width:100%;height:auto;background-color:initial></figure><div class=article-info><h1>Godot 3.0 new internals, progress report #4</h1><div class=article-metadata><div class=article-author><span>By:</span>
<img class=avatar width=25 height=25 src=/assets/images/authors/reduzio.webp alt="Juan Linietsky" loading=lazy>
<span class=by>Juan Linietsky</span></div><span class=date data-post-date="2017-02-04 00:00:00 +0000">4 February 2017</span></div><div class=tags><a href=/blog/progress-report><div class="tag active">Progress Report</div></a></div></div><div class="card card-warning"><p>This article is from <strong>February 2017</strong>, some of its contents might be outdated and no longer accurate.<br>You can find up-to-date information about the engine in the <a href=https://docs.godotengine.org/en/stable/>official documentation</a>.</div><div class=article-body><p>First of all, apologies for not being able to show flashy stuff this month! January was spent mostly updating Godot internals and breaking compatibility, now that we have the chance.<p>Most of the internal code in Godot was written over a decade ago, and many design decisions that were taken back then, did not stand the test of time. Nothing serious in general, just stuff that was either incorrect or overdesigned.<p>The result of this work has been mostly a lot of simplification in the internals, resulting in more performance and more readable code.<p>We also took the chance to rewrite key parts of Godot, which were considerably overdesigned (and dated), such as the audio engine, and the import framework.<h2 id=big-merge>Big merge</h2><p>While the 3.0 work was carried in the <em>gles3</em> branch, Rémi Verschelde and other main devs kept working on the <em>master</em> branch, cleaning up the repo and reorganizing third party libraries into a more maintainable form.<p>At the begining of January, the <em>gles3</em> branch was merged to <em>master</em>, which resulted in a pretty unusable repository.<p>This signalled the start of the process where all features that could not be implemented in previous versions, due to requiring breaking compatibility, could finally be implemented.<h2 id=internal-changes>Internal changes</h2><h5 id=new-memory-management-architecture>New memory management architecture</h5><p>All the internal memory management code in Godot was rewritten. This resulted in much simpler code and hopefully more performance.<h5 id=better-locking>Better locking</h5><p>Godot now implements readers-writers locks in many places, improving locking times when accessing some global data from multiple threads.<h5 id=local-resources>Local resources</h5><p>Resources can now be marked as local to the scene. This allows for simplifying some behaviors, such as using a Viewport directly as a texture in a Sprite, or creating button groups without a special control.<h5 id=fixed-rotation-angles>Fixed rotation angles</h5><p>Godot used rotations in XY instead of YX. Thanks to the great work of Fernc Arn/tagcup, all Godot math classes and functions should now be mathematically correct.<h5 id=made-signal-names-more-consistent>Made signal names more consistent</h5><p>Signals are now always in past tense (<em>e.g.</em> <code class="language-plaintext highlighter-rouge">mouse_exited</code>) to indicate an event just happened, or as verbs when an action is expected (<em>e.g.</em> <code class="language-plaintext highlighter-rouge">_draw</code>).<h2 id=gdscript>GDScript</h2><h5 id=scalars-are-64-bits>Scalars are 64-bits.</h5><p>This means that doing scalar integer math in GDScript, as well as storing these values to files, is fully 64 bits. Both integer and float types.<p>Support is also in progress (by Ferenc Arn/tagcup) to compile Godot using doubles for all math datatypes and functions. This is useful in case of desiring to create very large world without resorting to hacks such as moving the origin (at the cost of some performance).<h5 id=arrays-are-now-always-shareable>Arrays are now always shareable</h5><p>It was previously possible to declare arrays as atomic in GDScript, as in, copies did not keep the data shared. This resulted in several difficult to trace bugs. As a result, this functionality was removed.<h5 id=pool-arrays>Pool arrays</h5><p>Godot always supported these types, but their use was confusing due to their name (ByteArray, IntArray, etc)..<p>These are now called “Pool Arrays”. It means they use memory from the memory pool, which makes them safer to allocate large amounts of memory without causing fragmentation.<h5 id=renamed-many-math-types>Renamed many math types</h5><p>Many math types were also renamed to have more consistent naming.<p><img src=/storage/app/media/devlog/progress4/progress4-10.jpg alt><h5 id=dictionary-keeps-insertion-order>Dictionary keeps insertion order</h5><p>Dictionaries now remember the insertion order. When the list of keys is requested, or dictionaries are iterated, the order should always be the same. This helps make code more deterministic and avoids VCS inconsistencies in saved files.<p><img src=/storage/app/media/devlog/progress4/progress4-9.jpg alt><h4 id=automatically-enabled-callbacks>Automatically enabled callbacks</h4><p>Common Godot callbacks such as <code class="language-plaintext highlighter-rouge">_process</code>, <code class="language-plaintext highlighter-rouge">_input</code>, etc. required a funtion to enable them.<p>From Godot 3.0, if a callback is detected in the code, it is enabled automatically. Disabling it manually is still possible.<p>Additionally, some of the callbacks were renamed (<em>e.g.</em> <code class="language-plaintext highlighter-rouge">_input_event</code> became <code class="language-plaintext highlighter-rouge">_gui_input</code>).<h5 id=property-access-as-default>Property access as default</h5><p>Most of Godot’s API was exposed to GDScript as functions. This made browsing the doc and using some data somewhat cumbersome.<p>In Godot 3.0, most API access is done via properties:<p><img src=/storage/app/media/devlog/progress4/progress-4-4.jpg alt><p>This simplifies code a lot, as well as making the documentation easier to read.<p><img src=/storage/app/media/devlog/progress4/progress-4-5.jpg alt><h5 id=syntax-sugar-for-get_node>Syntax sugar for get_node()</h5><p>A simple syntax sugar was added for <code class="language-plaintext highlighter-rouge">get_node()</code>, a very commonly used function in Godot. This is done via the <code class="language-plaintext highlighter-rouge">$</code> operator:<p><img src=/storage/app/media/devlog/progress4/progress4-6.jpg alt><p>Together with the property accessor, makes GDScript look pretty different now…<p><img src=/storage/app/media/devlog/progress4/progress4-7.jpg alt><h5 id=_ready-is-called-only-once>_ready() is called only once.</h5><p>A common complaint from users is that <code class="language-plaintext highlighter-rouge">_ready()</code> was called again when a node is re-inserted into the scene after being removed.<p>By default, this callback is called only the first time. If you need it again, it can be requested with <code class="language-plaintext highlighter-rouge">request_ready()</code>.<h2 id=file-formats>File formats</h2><h5 id=filetype-deprecation>Filetype deprecation</h5><p>XML file format was removed in Godot 3.0. The TRES/TSCN formats are faster, more readable and more VCS friendly.<p>The venerable <code class="language-plaintext highlighter-rouge">engine.cfg</code> was renamed to <code class="language-plaintext highlighter-rouge">godot.cfg</code>. This new configuration file uses the same text serialization as .tres/.tscn, and is also versioned (so we can break compatibility more easily in future versions).<h5 id=better-json-parsing-in-gdscript>Better JSON parsing in GDScript</h5><p>A very requested feature, now JSON supports parsing into any datatype (not just dictionaries), as new built-in functions were added to GDScript to handle it.<h2 id=gui>GUI</h2><h5 id=ratio-anchoring-removed>Ratio anchoring removed</h5><p>Ratio anchoring was removed in controls. It was deprecated a long time ago since Godot added container support, but it could not be removed due to fear of breaking compatibility.<h5 id=better-handling-of-stopignore-mouse-in-controls>Better handling of Stop/Ignore mouse in controls</h5><p>This area was pretty confusing in Godot 2.x, so the whole amount of options was moved to a single enum. Additionally, Drag&Drop now support these too.<h5 id=opacity--self-opacity-removed>Opacity / self opacity removed</h5><p>Controls (and 2D nodes) now have <code class="language-plaintext highlighter-rouge">modulate</code> and <code class="language-plaintext highlighter-rouge">self_modulate</code> properties, which both change the opacity and the color of control and branch.<p><img src=/storage/app/media/devlog/progress4/progress4-8.jpg alt><h2 id=editor>Editor</h2><h5 id=settings-are-better-categorized>Settings are better categorized</h5><p>This is another area where breaking compatibility helped a lot. Both Editor and Project settings are now cleaner and better organized:<p><img src=/storage/app/media/devlog/progress4/progress4-1.jpg alt><h5 id=named-layers>Named layers</h5><p>Physics, 2D and 3D layers can now be assigned names.<p><img src=/storage/app/media/devlog/progress4/progress4-2.jpg alt><h5 id=better-project-settings-editing>Better project settings editing</h5><p>Project settings window was confusing because of the double checkboxes (one for persist and another for option value). This was removed in favor of a “revert” button.<p><img src=/storage/app/media/devlog/progress4/progress4-3.jpg alt><h2 id=new-audio-engine>New audio engine</h2><p>As 3.0 is <em>the</em> compatibility breaking release, we took the chance to rewrite the audio engine too.<h5 id=only-streams>Only streams</h5><p>Godot 2.x used a separate concept for <em>Samples</em> and <em>Streams</em>. Godot 3.0 simplifies the audio engine enormously by just supporting streams. Streams can be either .ogg or .wav depending on your needs, which are usually:<ul><li>.ogg files are small in both disk and memory, but expensive to reproduce and very expensive to resample (change pitch).<li>.wav files as PCM take up a lot of disk and RAM, but are cheap to reproduce (in the hundreds simuntaneous streams), can be seeked and played in reverse.<li>.wav files as IMA-ADPCM are in the middle of .ogg and PCM: they take up to 4 times less space than PCM, are also cheap to reproduce, but cannot be seeked.</ul><h5 id=playback>Playback</h5><p>Only 3 nodes are needed to play back audio:<ul><li>AudioPlayer, which is a generic player.<li>AudioSource, which works for 3D positional audio.<li>AudioSource2D, which is the same but for 2D.</ul><h5 id=buses>Buses</h5><p>The new audio engine has buses. Nodes that play back audio can choose which buses to send audio to.<p><img src=/storage/app/media/devlog/progress4/progress4-11.jpg alt><h5 id=built-in-effects>Built-in effects</h5><p>Godot 3.0 also comes with a large library of built-in effects which can be assigned to each bus. As there is not much open source audio code with a MIT compatible license we could re-use, these were written specially for Godot (and sounds great!).<p><img src=/storage/app/media/devlog/progress4/progress4-12.jpg alt><h2 id=new-import-system>New import system</h2><p>One common complaint from Godot users is that many asset types need to be imported in order to be used, or in order to change certain types of flags.<p>For this, they have to be kept outside the project folder, but close enough to be referenced by the import versions.<h5 id=automatic-import>Automatic import</h5><p>Godot 3.0 simplifies this process a lot, by performing automatic import. Original assets are placed directly in the project folder (<em>e.g.</em> .dae scenes, images, etc.), and Godot will perform an internal and automatic import.<p>Users, then, can still refer to the original assets as if they were the actual resources (while the generated, imported resources are placed in a <code class="language-plaintext highlighter-rouge">res://.import</code> shadow dir). At export time, the original assets are removed and replaced by the imported versions.<p><img src=/storage/app/media/devlog/progress4/progress4-13.jpg alt><h5 id=import-dock>Import dock</h5><p>Even though import is automatic, it’s still possible to specify large amount of options per asset, and re-import. This is done via the new Import dock.<p><img src=/storage/app/media/devlog/progress4/progress4-14.jpg alt><h2 id=future>Future</h2><p>With this, the large bulk of changes required for breaking compatibility are mostly complete. Next months will be focused in closing the remaining renderer features and stabilizing Godot for an alpha release.<h2 id=seeing-the-code>Seeing the code</h2><p>If you are interested in seeing what each feature looks like in the code, you can check the <a href=https://github.com/godotengine/godot/commits/master>master</a> branch on GitHub.</div></div></article></div><link rel=stylesheet href=/assets/css/anchor-link.css?1><link rel=stylesheet href=/assets/css/article-cards.css?2><script src=/assets/js/anchor-link.js></script>
<script>document.addEventListener('DOMContentLoaded',()=>{window.applyAnchorLinks('.article-body'),document.querySelectorAll('.article-cover img, .article-body img').forEach(b=>{if(b.classList.contains('lightbox-ignore'))return;const a=document.createElement('a');a.href=b.src,a.classList.add('lightbox'),a.dataset.group='article',b.parentNode.appendChild(a),a.appendChild(b)})})</script></main><footer><div class="container flex footer-container"><div id=copyright><p>© 2007-2024 Juan Linietsky, Ariel Manzur and <a href=https://github.com/godotengine/godot/blob/master/AUTHORS.md target=_blank rel=noopener>contributors</a>.<br>Hosted by the <a href=https://godot.foundation/ target=_blank rel=noopener>Godot Foundation</a>.<br>Website <a href=https://github.com/godotengine/godot-website target=_blank rel=noopener>source code on GitHub</a>.</div><div id=sitemap><ul class=sitemap-group><li><strong>Get Godot</strong><li><a href=/download/windows/ class=set-os-download-url>Download</a><li><a href=/download/archive/>Release Archive</a><li><a href=https://editor.godotengine.org/releases/latest/>Web Editor</a><li>&nbsp;<li><strong>Public Relations</strong><li><a href=/blog/>Blog</a><li><a href=/community/>Communities and Events</a><li><a href=/press/>Press Kit</a></ul><ul class=sitemap-group><li><strong>About Godot</strong><li><a href=/features/>Features</a><li><a href=/showcase/>Showcase</a><li><a href=/education/>Education</a><li><a href=/license/>License</a><li><a href=/code-of-conduct/>Code of Conduct</a><li><a href=/privacy-policy/>Privacy Policy</a><li><a href=https://fund.godotengine.org>Donate</a></ul><ul class=sitemap-group><li><strong>Project Team</strong><li><a href=/governance/>Governance</a><li><a href=/teams/>Teams</a><li>&nbsp;<li><strong>Extra Resources</strong><li><a href=https://godotengine.org/asset-library/asset>Asset Library</a><li><a href=https://docs.godotengine.org>Documentation</a><li><a href=https://github.com/godotengine>Code Repository</a></ul></div><div id=social class=dark-desaturate><h4 class=text-right><a href=/contact/>Contact us</a></h4><div class="flex justify-space-between" style=gap:3px><a href=https://github.com/godotengine target=_blank rel=noopener><img src=/assets/footer/github_logo.svg width=32 height=32 alt=GitHub></a>
<a href=https://mastodon.gamedev.place/@godotengine target=_blank rel=noopener><img src=/assets/footer/mastodon_logo.svg width=32 height=32 alt=Mastodon></a>
<a href=https://twitter.com/godotengine target=_blank rel=noopener><img src=/assets/footer/twitter_logo.svg width=32 height=32 alt=Twitter></a>
<a href=https://www.facebook.com/groups/godotengine/ target=_blank rel=noopener><img src=/assets/footer/facebook_logo.svg width=32 height=32 alt=Facebook></a>
<a href=https://www.reddit.com/r/godot target=_blank rel=noopener><img src=/assets/footer/reddit_logo.svg width=32 height=32 alt=Red​dit></a>
<a href=/rss.xml target=_blank rel=noopener><img src=/assets/footer/feed_logo.svg width=32 height=32 alt="RSS feed"></a></div></div></div></footer><script defer src=/assets/js/tobii.min.js></script>
<script defer src=/assets/js/highlight.min.js?1></script>
<script defer src=/assets/js/highlight.gdscript.min.js?1></script>
<script>document.addEventListener('DOMContentLoaded',()=>{document.querySelectorAll('pre code').forEach(a=>{hljs.highlightBlock(a)}),document.querySelectorAll('[data-post-date]').forEach(a=>{Date.parse(a.dataset.postDate)>Date.now()-1e3*60*60*48&&a.classList.add("post-recent-highlight")}),new Tobii({zoom:!1});const a=document.querySelectorAll('.set-os-download-url');for(let b=0;b<a.length;b++){const c=a[b];let e='download';'version'in c.dataset&&c.dataset.version==='3'&&(e='download/3.x');let d='windows';navigator.platform.indexOf('Mac')!==-1?d='macos':navigator.platform.indexOf('Linux')!==-1&&(d='linux'),c.href=`/${e}/${d}/`}})</script>